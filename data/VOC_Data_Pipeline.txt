= #"Imported Excel Workbook"{[Item="Export",Kind="Sheet"]}[Data]

= Table.PromoteHeaders(Export_Sheet, [PromoteAllScalars=true])

= Table.TransformColumnTypes(#"Promoted Headers",{{"URL", type text}, {"Fuente", type text}, {"Survey Date", type date}, {"ZP8_Date", type date}, {"Car Model", type text}, {"Trim", type text}, {"id", Int64.Type}, {"Texto", type text}, {"Topic_ids", type text}, {"Phrases", type text}, {"Score", Int64.Type}, {"Engine", type text}, {"Gearbox Code", type text}, {"Gearbox", type text}, {"Category Hierarchy - Category", type text}, {"Category Hierarchy - Specific part", type text}, {"Category Hierarchy - Details_name", type text}, {"Category Hierarchy - MoreInfo_name", type text}, {"Analyst_comment", type text}, {"Responsibles", type text}, {"UX", type text}, {"Title", type text}, {"Feedback type", type text}})

= Table.RemoveColumns(#"Changed Type",{"Trim", "Texto", "Phrases", "Engine", "Gearbox Code", "Gearbox", "Analyst_comment"})

= Table.AddColumn(#"Removed Columns", "Custom", each Text.Split([Topic_ids], "#(lf)"))

= Table.ExpandListColumn(#"Added Custom", "Custom")

= Table.ReorderColumns(#"Expanded Custom",{"URL", "Fuente", "Survey Date", "ZP8_Date", "Car Model", "id", "Topic_ids", "Custom", "Score", "Category Hierarchy - Category", "Category Hierarchy - Specific part", "Category Hierarchy - Details_name", "Category Hierarchy - MoreInfo_name", "Responsibles", "UX", "Title", "Feedback type"})

= Table.RemoveColumns(#"Reordered Columns",{"URL", "ZP8_Date"})

= Table.SplitColumn(#"Removed Columns1", "Car Model", Splitter.SplitTextByEachDelimiter({"_"}, QuoteStyle.Csv, false), {"Car Model.1", "Car Model.2"})

= Table.TransformColumnTypes(#"Split Column by Delimiter",{{"Car Model.1", type text}, {"Car Model.2", type text}})

= Table.RenameColumns(#"Changed Type1",{{"Car Model.1", "CarBrand"}, {"Car Model.2", "CarModel"}, {"Custom", "SingleTopicID"}})

= Table.SelectRows(#"Renamed Columns", each Text.Contains([SingleTopicID], "::"))

= Table.RemoveColumns(#"Filtered Rows",{"Category Hierarchy - Category", "Category Hierarchy - Specific part", "Category Hierarchy - Details_name", "Category Hierarchy - MoreInfo_name", "Topic_ids"})

= Table.SelectRows(#"Renamed Columns", each Text.Contains([SingleTopicID], "::"))

= Table.RemoveColumns(#"Filtered Rows",{"Category Hierarchy - Category", "Category Hierarchy - Specific part", "Category Hierarchy - Details_name", "Category Hierarchy - MoreInfo_name", "Topic_ids"})

= Table.DuplicateColumn(#"Removed Columns2", "SingleTopicID", "SingleTopicID - Copy")

= Table.RenameColumns(#"Duplicated Column",{{"SingleTopicID - Copy", "SingleTopicID_Split"}})

= Table.SplitColumn(#"Renamed Columns1", "SingleTopicID_Split", Splitter.SplitTextByDelimiter("::", QuoteStyle.Csv), {"SingleTopicID.1", "SingleTopicID.2", "SingleTopicID.3", "SingleTopicID.4"})

= Table.RenameColumns(#"Split Column by Delimiter1",{{"SingleTopicID.1", "TopicHierarchy_L1_Category"}, {"SingleTopicID.2", "TopicHierarchy_L2_SpecificPart"}, {"SingleTopicID.3", "TopicHierarchy_L3_Details"}, {"SingleTopicID.4", "TopicHierarchy_L4_MoreInfo"}})